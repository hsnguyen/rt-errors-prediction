#! /usr/bin/env python
import sys
import re


inFileName = sys.argv[1]
outFileName = sys.argv[2]


inFile = open(inFileName,"r")
outFile = open(outFileName, "w")

#motifList = ["QCQQ", "QQPPH[PQ]QC", "QHHCPQPQC", "CCCQPCCC", "QPH[PQ][PQ]CC[HQ]Q", "CCCCCCCC", "Q[CQ][CQ]Q", "Q[HQ]H[PQ]P[HQ]PQC", "QQ" ] 
motifList = ["QQQHHQHQ", "Q[HQ][HQ]Q[PQ]PQQ", "QCPPHQQCC", "QCQQ[CH]CC", "CCQCCCCC", "CCCCCCCC", "Q[CQ]Q[CQ]", "Q[CQ][CQ]Q", "[CQ][CQ]CC[CQ]Q", "CCCC[CP][CQ]CC" ] 

outFile.write("@relation motifOccurances \n")


for motif in motifList: 
    outFile.write("@attribute "+motif+" real\n")

outFile.write("@attribute errorPercent real\n")

outFile.write("\n @data \n")

for ln in inFile.readlines():
    
    motifOccurances = ""
    sequence = ln.split()[0]
    errorPercent = ln.split()[1]
    
    for motif in motifList:
        result = re.findall(motif, sequence)
        
        if (result == None):
            motifOccurances += "0 "
        else:
            motifOccurances += (str(len(result))+" ")
     
    outFile.write(motifOccurances+" "+errorPercent+"\n")

